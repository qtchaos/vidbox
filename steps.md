# Preface

VidBox, a popular video streaming platform, has recently implemented a stream key system to combat content piracy and bandwidth theft. This system generates a short-lived key that's required to access video streams, making it seemingly impossible to keep the video link alive for more than a minute.

You are a security researcher who has been tasked with finding a way to bypass this security feature by creating a stream key thats valid for a longer period of time, allowing you to share this link with your friends for the foreseeable future, are you up for the task?

# Step 1

Investigate the website at http://MACHINE_IP and try to figure out how the video is being protected. The stream key looks mangled, like it's been encrypted with some sort of algorithm... but which one?

answer: `AES-ECB`\
hint: Try to investigate the streaming server, an exposed config file might be of use.\
hint2: Try visiting the root of the server, see if theres's anything interesting there.

# Step 2

The key is being generated on the client, there has to be a way to find where this is being done. Try to look for the logic that generates the key, it might not be where you think it is.

What file is the encryption logic being stored in?

answer: `loading.png`\
hint: A common technique for obfuscating anything on the web is to use a file format different from the original, for example storing an `mp4` inside of a file with the `.png` extension.\
hint2: Look at the network tab in the browser's developer tools, see if there are any images being loaded that aren't visible on the page.

# Step 3

The encryption logic is being stored in a PNG file that's being loaded by the browser. Upon opening the file you will find that the code inside is mangled and unreadable. You need to find a way to deobfuscate the code and get the **three** keys being used to generate the stream key. The order of the keys matters, you need to figure out in what order they are being used.

What is the first key? answer: `a3s_is_qu1te_7uf`\
hint: You can deobfuscate the code by using a tool like https://deobfuscate.relative.im/ or https://webcrack.netlify.app/

# Step 4

In order for you to generate your own stream key, you need to find the second key.

What is the second key? answer: `ee.vidbox.client`\
hint: This key is using reverse domain name notation (i.e com.google.client).

# Step 5

The third and final key is split into two parts, both are sentences and you need to concatenate them together to get the plaintext string answer. The key used for encryption is generated by using a checksum functions on both parts of the key and then concatenating them together.

What is the plaintext used for the key? answer: `I meant what I said and I said what I meant. A pirate's faithful one-hundred percent!`\
What is the final key that's used for encryption? answer: `385fde599564b1e5`

# Step 6

Now that you have all the keys, you can generate your own stream key using whatever UNIX time you want! Generate a valid stream key that's sometime in the future and try it out.

answer: `vidbox{look_mom_im_a_pirate}`\
hint: You get the key by requesting the demo video stream using a stream key that's atleast a day in the future.
